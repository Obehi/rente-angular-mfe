<div class="front-container">
  <section *ngIf="!isLoginStarted && bankIdForm" class="login">
    <h3>Logg inn med BankID på mobil</h3>
    <p>
      Renteradar henter lånedetaljer og renten din automatisk med BankID på
      Mobil.
    </p>
    <p *ngIf="isSB1Bank">
      Vi støtter kun BankID på Mobil, ikke kodebrikke eller engangskode appen.
    </p>
    <p *ngIf="!isSB1Bank">
      Vi støtter kun BankID på Mobil, ikke kodebrikke og passord.
    </p>
    <p *ngIf="isEikaBank && false" class="red">
      OBS: Vi tester fortsatt løsningen for denne banken. <br />
      Gi gjerne beskjed hvis noe ikke fungerer optimalt.
    </p>

    <form
      [formGroup]="bankIdForm"
      novalidate
      (ngSubmit)="startLogin(bankIdForm.value)"
    >
      <img
        class="bank-logo"
        [src]="bankLogo"
        [alt]="bank.label"
        [title]="bank.label"
      />

      <div *ngIf="isSsnBankLogin; else birthdateInput" class="form-group">
        <rente-input
          [errorStateMatcher]="
            isErrorState(bankIdForm.controls['ssn'], bankIdForm)
          "
          [placeholder]="'Ditt fødselsnummer (11 siffer)'"
          formControlName="ssn"
          [mask]="ssnMask"
          [type]="'tel'"
          [modelOptions]="{ updateOn: 'blur' }"
        >
        </rente-input>
        <div class="error-message" *ngIf="bankIdForm.controls['ssn'].touched">
          <rente-form-message
            class="text-left d-block"
            *ngIf="bankIdForm.controls['ssn'].hasError('required')"
            [type]="'error'"
          >
            Fødselsnummer kan ikke være tomt
          </rente-form-message>
          <rente-form-message
            class="text-left d-block"
            *ngIf="bankIdForm.controls['ssn'].hasError('pattern')"
            [type]="'error'"
          >
            Fødselsnummer ikke gyldig
          </rente-form-message>
          <rente-form-message
            class="text-left d-block"
            *ngIf="bankIdForm.controls['ssn'].hasError('ssnNotValid')"
            [type]="'error'"
          >
            Fødselsnummeret er ikke gyldig
          </rente-form-message>
        </div>
      </div>

      <ng-template #birthdateInput>
        <div class="form-group">
          <rente-input
            [errorStateMatcher]="
              isErrorState(bankIdForm.controls['birthdate'], bankIdForm)
            "
            [placeholder]="'Din fødselsdato (ddmmåå)'"
            formControlName="birthdate"
            [mask]="birthdateMask"
            [type]="'tel'"
            [modelOptions]="{ updateOn: 'blur' }"
          >
          </rente-input>
          <div
            class="error-message"
            *ngIf="bankIdForm.controls['birthdate'].touched"
          >
            <rente-form-message
              class="text-left d-block"
              *ngIf="bankIdForm.controls['birthdate'].hasError('required')"
              [type]="'error'"
            >
              Fødselsdato kan ikke være tomt
            </rente-form-message>
            <rente-form-message
              class="text-left d-block"
              *ngIf="bankIdForm.controls['birthdate'].hasError('pattern')"
              [type]="'error'"
            >
              Fødselsdato ikke gyldig
            </rente-form-message>
          </div>
        </div>
      </ng-template>

      <div class="form-group">
        <rente-input
          [errorStateMatcher]="
            isErrorState(bankIdForm.controls['phone'], bankIdForm)
          "
          [placeholder]="'Ditt mobilnummer (8 siffer)'"
          formControlName="phone"
          [mask]="phoneMask"
          [type]="'tel'"
          [modelOptions]="{ updateOn: 'blur' }"
        >
        </rente-input>
        <div class="error-message" *ngIf="bankIdForm.controls['phone'].touched">
          <rente-form-message
            class="text-left d-block"
            *ngIf="bankIdForm.controls['phone'].hasError('required')"
            [type]="'error'"
          >
            Telefonnummer kan ikke være tomt
          </rente-form-message>
          <rente-form-message
            class="text-left d-block"
            *ngIf="bankIdForm.controls['phone'].hasError('pattern')"
            [type]="'error'"
          >
            Telefonnummer ikke gyldig
          </rente-form-message>
        </div>
      </div>

      <mat-checkbox
        formControlName="confirmation"
        (change)="isConfirmed = $event.checked"
      >
        Jeg aksepterer Renteradar.no's
        <a class="link" (click)="openServiceDialog()">vilkår</a>
      </mat-checkbox>

      <div class="register-btn">
        <rente-button
          color="primary"
          [disabled]="!bankIdForm.valid || !isConfirmed"
        >
          Logg inn
        </rente-button>
      </div>
    </form>
  </section>

  <rente-login-status
    *ngIf="isLoginStarted"
    [userData]="userData"
    [bank]="bank"
    (returnToInputPage)="isLoginStarted = false"
  >
  </rente-login-status>
</div>
