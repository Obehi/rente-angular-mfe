<div class="summary">
  <div class="loan-boxes">
    <div
      [ngClass]="
        isEditMode === true ? 'content-blue-box-edit' : 'content-blue-box'
      "
    >
      <div class="loan-type">
        <div class="loan-delete">
          <h3>Lån {{ index + 1 }}</h3>
          <!-- <div *ngIf="!isEditMode"></div> -->
          <mat-icon *ngIf="isEditMode" (click)="deleteLoan()"
            >delete_forever</mat-icon
          >
        </div>

        <div>
          <img
            [hidden]="hideEditIcon"
            (click)="setEditEnabled()"
            class="loan-edit"
            src="../../../../../../assets/icons/edit-icon-grey.svg"
            alt="loan-edit"
          />
          <img
            [hidden]="!isEditMode"
            (click)="setEditDisabled()"
            class="loan-edit-cancel"
            src="../../../../../../assets/icons/cancel-icon-grey.svg"
            alt="loan-edit-cancel"
          />
        </div>
      </div>

      <div
        class="all-text"
        *ngIf="!isEditMode"
        [@fadeOut]="isEditMode ? 'hidden' : 'visible'"
      >
        <div class="loan-center">
          <p>
            {{ loan.loanName }}
          </p>
        </div>
      </div>

      <div
        class="forms"
        *ngIf="loanForm"
        [ngClass]="isEditMode === true ? 'edit-modus' : 'general-modus'"
      >
        <form class="p-0 border-0" [formGroup]="loanForm" novalidate change>
          <div class="field-box">
            <h4 class="text-white">Utestående lån:</h4>

            <div
              [ngClass]="{
                'active-input': inEditMode === true,
                'non-active-input': isEditMode === false,
                'edit-focus':
                  isEditMode === true && inputOutstandingDebtIsActive === true
              }"
              (click)="setInputOutDebtActive()"
            >
              <mat-form-field class="white-input w-75" appearance="outline">
                <input
                  placeholder="Skriv inn din lån"
                  matInput
                  type="tel"
                  maxlength="16"
                  autocomplete="off"
                  [formControlName]="'outstandingDebt'"
                  currencyMask
                  [options]="{
                    prefix: '',
                    suffix: ' kr',
                    align: 'center',
                    thousands: ' ',
                    decimal: ',',
                    precision: 1
                  }"
                />
              </mat-form-field>

              <div
                *ngIf="loanForm.controls['outstandingDebt'].touched"
                class="error-message"
              >
                <rente-form-message
                  class="d-block"
                  [type]="'error'"
                  *ngIf="
                    loanForm.controls['outstandingDebt'].hasError('required')
                  "
                >
                  Kan ikke være tom
                </rente-form-message>
              </div>
            </div>
          </div>

          <div class="field-box">
            <h4 class="text-white">Løpetid:</h4>

            <div
              [ngClass]="{
                'active-input': inEditMode === true,
                'non-active-input': isEditMode === false,
                'edit-focus': inputRemainingYearsIsActive === true,
                'edit-error':
                  remainingYearsIsError === true &&
                  inputRemainingYearsIsActive === false
              }"
              (click)="setInputRemYearsActive()"
            >
              <mat-form-field class="white-input w-130" appearance="outline">
                <input
                  placeholder="Løpetid"
                  matInput
                  type="tel"
                  maxlength="9"
                  autocomplete="off"
                  [formControlName]="'remainingYears'"
                  currencyMask
                  [options]="{
                    prefix: '',
                    suffix: ' år',
                    align: 'center',
                    thousands: ' ',
                    decimal: ',',
                    precision: 2
                  }"
                />
              </mat-form-field>

              <div
                *ngIf="loanForm.controls['remainingYears'].touched"
                class="error-message"
              >
                <rente-form-message
                  class="d-block"
                  [type]="'error'"
                  *ngIf="
                    loanForm.controls['remainingYears'].hasError('required')
                  "
                >
                  Kan ikke være tom
                </rente-form-message>
              </div>
            </div>
          </div>

          <div class="field-box">
            <h4 class="text-white">Nominell rente:</h4>

            <div
              [ngClass]="{
                'active-input': inEditMode === true,
                'non-active-input': isEditMode === false,
                'edit-focus': inputNominalRateIsActive === true,
                'edit-error':
                  nominalRateIsError === true &&
                  inputNominalRateIsActive === false
              }"
              (click)="setInputNominalRateActive()"
            >
              <mat-form-field class="white-input w-130" appearance="outline">
                <input
                  placeholder="Nominell rente"
                  matInput
                  type="tel"
                  maxlength="7"
                  autocomplete="off"
                  [formControlName]="'nominalRate'"
                  currencyMask
                  [options]="{
                    prefix: '',
                    suffix: ' %',
                    align: 'center',
                    thousands: ' ',
                    decimal: ',',
                    precision: 2
                  }"
                />
              </mat-form-field>

              <div
                *ngIf="loanForm.controls['nominalRate'].touched"
                class="error-message"
              >
                <rente-form-message
                  class="d-block"
                  [type]="'error'"
                  *ngIf="loanForm.controls['nominalRate'].hasError('required')"
                >
                  Kan ikke være tom
                </rente-form-message>
              </div>
            </div>
          </div>

          <div
            class="loan-info"
            *ngIf="showDisplayBox"
            [@fadeOut]="isEditMode ? 'hidden' : 'visible'"
          >
            <div>
              <p>Effektiv rente:</p>
            </div>
            <div>
              <h3>{{ loan.effectiveRate | number: '1.2-2' }} %</h3>
            </div>
          </div>
        </form>
      </div>

      <div
        class="total-cost"
        *ngIf="showDisplayBox"
        [@fadeOut]="isEditMode ? 'hidden' : 'visible'"
      >
        <div class="double-container">
          <div class="first-box move-first-box">
            <div class="btitle-one">
              <p>Totale renter og gebyrer</p>
            </div>
            <div class="bvalue">
              {{
                loan.totalInterestAndTotalFee == null
                  ? 'N/A'
                  : (loan.totalInterestAndTotalFee | number: '1.0-0') + ',-'
              }}
            </div>
          </div>

          <div class="first-box move-sec-box">
            <div class="btitle-two">
              <p>Renter & gebyrer per år</p>
            </div>
            <div class="bvalue">
              {{
                loan.totalInterestAndTotalFeeByRemainingYears == null
                  ? 'N/A'
                  : (loan.totalInterestAndTotalFeeByRemainingYears
                      | number: '1.0-0') + ',-'
              }}
            </div>
          </div>
        </div>
      </div>

      <div
        class="save-loan-button"
        *ngIf="isEditMode"
        [@buttonFadeInOut]="showButton ? 'visible' : 'hidden'"
      >
        <rente-button
          color="primary"
          (click)="save()"
          [disabled]="isDisabled === true"
        >
          Lagre
        </rente-button>
      </div>
    </div>
  </div>
</div>
