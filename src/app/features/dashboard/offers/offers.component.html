<div class="loading" *ngIf="isLoading && !errorMessage">
  <mat-spinner [diameter]="48" [strokeWidth]="4"></mat-spinner>
</div>

<div
  class="offers"
  *ngIf="offersInfo?.resultType === offersResultType.OFFERS_PRESENT"
>
  <!-- Mobile Tips -->
  <div class="mobile">
    <div
      class="tipsAccordion"
      (click)="isShowTips = !isShowTips"
      *ngIf="tips.length > 0"
    >
      <p>
        <mat-icon *ngIf="!isShowTips">expand_more</mat-icon>
        <mat-icon *ngIf="isShowTips">expand_less</mat-icon>
        <span class="nr">{{ tips.length }}</span> tips
      </p>
    </div>
    <div
      class="tips"
      style="border-bottom: none;"
      *ngIf="tips.length > 0 && !isShowTips"
    ></div>
    <div class="tips" *ngIf="isShowTips && tips.length > 0">
      <div *ngFor="let tip of tips; let i = index">
        <div
          *ngIf="!tip.external"
          routerLink="{{ tip.buttonLink }}"
          class="tip"
        >
          <p>
            {{ tip.text }}
          </p>

          <mat-icon *ngIf="tip.buttonLink !== './'">chevron_right</mat-icon>
        </div>

        <a
          *ngIf="tip.external"
          href="{{ tip.buttonLink }}"
          target="_blank"
          class="tip"
        >
          <p>
            {{ tip.text }}
          </p>

          <mat-icon>chevron_right</mat-icon>
        </a>
      </div>
    </div>
  </div>
  <!-- Mobile Tips -->
  <div class="split-sections">
    <div class="split-section">
      <div class="barometer">
        <h3>Rentebarometer</h3>
        <rente-rating
          [rating]="
            offersService.getRatingNumberFromLoanState(
              offersInfo.offerSavingsType
            )
          "
        ></rente-rating>
        <div class="rente-status" [ngSwitch]="offersInfo.offerSavingsType">
          <p *ngSwitchCase="offerSavingsType.NO_SAVINGS">
            Renten din er <b>svært god</b>
          </p>
          <p
            *ngSwitchCase="
              offerSavingsType.SAVINGS_FIRST_YEAR_BETWEEN_0_AND_2000
            "
          >
            Renten din er <b>god</b>, men ikke best
          </p>
          <p
            *ngSwitchCase="
              offerSavingsType.SAVINGS_FIRST_YEAR_BETWEEN_2000_AND_6000
            "
          >
            Renten din er <b>OK</b>, med du kan få bedre
          </p>
          <p
            *ngSwitchCase="
              offerSavingsType.SAVINGS_FIRST_YEAR_BETWEEN_6000_AND_10000
            "
          >
            Renten din er <b>høy</b> og du kan spare en del
          </p>
          <p *ngSwitchCase="offerSavingsType.SAVINGS_FIRST_YEAR_GREATER_10000">
            Renten din er <b>svært høy</b> – du har mye å spare
          </p>
          <div *ngSwitchDefault>-</div>
        </div>

        <!-- Mobile boxes -->
        <div class="rente-boxes mobile">
          <div class="box positive">
            <p>Du kan spare</p>
            <h2 *ngIf="offersInfo.bestOfferTotalSaving > 0; else noBestOffer">
              {{ offersInfo.bestOfferTotalSaving | abs | number }},-
            </h2>
            <ng-template #noBestOffer>
              <h2>0,-</h2>
            </ng-template>
            <p>over lånets løpetid</p>
          </div>
          <div class="double">
            <div class="box">
              <p>Din eff. rente</p>
              <h2>{{ offersInfo.totalEffectiveRate | number: "1.2-2" }}%</h2>
            </div>
            <div class="box positive" (click)="goToBestOffer()">
              <p>
                Beste tilbud <img src="../../../../assets/icons/go_to.svg" />
              </p>
              <h2>
                {{ offersInfo.bestOfferEffectiveRate | number: "1.2-2" }}%
              </h2>
              <!-- <h2>{{ offersInfo.customerName | null }}</h2> -->
            </div>
          </div>
          <div class="double">
            <div class="box">
              <p>Boligverdi</p>
              <h2>
                {{ offersInfo.propertyValue / 1000000 | number: "1.1-3" }}
                mill.
              </h2>
              <p class="small">
                Estimat levert av
                <a href="https://virdi.no/" target="_blank">virdi.no</a>
              </p>
            </div>
            <div class="box">
              <p>Gjenværende lån</p>
              <h2>
                {{
                  offersInfo.totalOutstandingDebt / 1000000 | number: "1.1-3"
                }}
                mill.
              </h2>
              <p class="small">
                Belåningsgrad
                {{
                  (offersInfo.totalOutstandingDebt / offersInfo.propertyValue) *
                    100 | number: "1.1-1"
                }}%
              </p>
            </div>
          </div>

          <rente-button
            [disabled]="
              changeBankLoading ||
              offersInfo.offerSavingsType === offerSavingsType.NO_SAVINGS
            "
            [isLoading]="changeBankLoading"
            color="primary"
            type="raised"
            (click)="openChangeBankDialog(offersInfo.offers[0])"
            >Be banken matche tilbud</rente-button
          >
        </div>
        <!-- Mobile boxes -->
      </div>
      <div class="desktop" style="margin-bottom: 40px;">
        <div
          class="tipsAccordion clickable"
          (click)="isShowTips = !isShowTips"
          *ngIf="tips.length > 0"
        >
          <p>
            <mat-icon *ngIf="!isShowTips">expand_more</mat-icon>
            <mat-icon *ngIf="isShowTips">expand_less</mat-icon>
            <span class="nr">{{ tips.length }}</span> tips
          </p>
        </div>
        <div
          class="tips"
          style="border-bottom: none;"
          *ngIf="tips.length > 0 && !isShowTips"
        ></div>
        <div class="tips" *ngIf="isShowTips && tips.length > 0">
          <div
            *ngFor="let tip of tips; let i = index"
            [ngClass]="tip.buttonLink === './' ? '' : 'clickable'"
          >
            <div
              *ngIf="!tip.external"
              routerLink="{{ tip.buttonLink }}"
              class="tip"
            >
              <p>
                {{ tip.text }}
              </p>

              <mat-icon *ngIf="tip.buttonLink !== './'">chevron_right</mat-icon>
            </div>

            <a
              *ngIf="tip.external"
              href="{{ tip.buttonLink }}"
              target="_blank"
              class="tip"
            >
              <p>
                {{ tip.text }}
              </p>

              <mat-icon>chevron_right</mat-icon>
            </a>
          </div>
        </div>
      </div>
      <div class="compared">
        <rente-offers-statistics [offersInfo]="offersInfo">
        </rente-offers-statistics>
      </div>
    </div>
    <div class="split-section">
      <!-- Desktop boxes -->
      <div class="rente-boxes desktop">
        <div class="box positive">
          <p>Du kan spare</p>
          <h2 *ngIf="offersInfo.bestOfferTotalSaving > 0; else noBestOffer">
            {{ offersInfo.bestOfferTotalSaving | abs | number }},-
          </h2>
          <ng-template #noBestOffer>
            <h2>0,-</h2>
          </ng-template>
          <p>over lånets løpetid</p>
        </div>
        <div class="double">
          <div class="box">
            <p>Din eff. rente</p>
            <h2>{{ offersInfo.totalEffectiveRate | number: "1.2-2" }}%</h2>
          </div>
          <div class="box positive clickable" (click)="goToBestOffer()">
            <p>Beste tilbud <img src="../../../../assets/icons/go_to.svg" /></p>
            <h2>{{ offersInfo.bestOfferEffectiveRate | number: "1.2-2" }}%</h2>
            <!-- <h2>{{ offersInfo.customerName | null }}</h2> -->
          </div>
        </div>
        <div class="double">
          <div class="box">
            <p>Boligverdi</p>
            <h2>
              {{ offersInfo.propertyValue / 1000000 | number: "1.1-3" }}
              mill.
            </h2>
            <p class="small">
              Estimat levert av
              <a href="https://virdi.no/" target="_blank">virdi.no</a>
            </p>
          </div>
          <div class="box">
            <p>Gjenværende lån</p>
            <h2>
              {{ offersInfo.totalOutstandingDebt / 1000000 | number: "1.1-3" }}
              mill.
            </h2>
            <p class="small">
              Belåningsgrad
              {{
                (offersInfo.totalOutstandingDebt / offersInfo.propertyValue) *
                  100 | number: "1.1-1"
              }}%
            </p>
          </div>
        </div>

        <rente-button
          [disabled]="
            changeBankLoading ||
            offersInfo.offerSavingsType === offerSavingsType.NO_SAVINGS
          "
          [isLoading]="changeBankLoading"
          color="primary"
          type="raised"
          (click)="openChangeBankDialog(offersInfo.offers[0])"
          >Be banken matche tilbud</rente-button
        >
      </div>
      <!-- Desktop boxes -->
    </div>
  </div>

  <div class="the-offers">
    <h3 style="margin-bottom: 20px;">
      {{ offersInfo.offers.length }} bedre tilbud
    </h3>
    <div class="offers-grid">
      <ng-container *ngIf="offersInfo">
        <div
          *ngFor="let offer of offersInfo.offers; let i = index"
          class="the-offer"
        >
          <div class="the-offer-header">
            <div
              class="logo"
              [ngStyle]="{
                'background-image': 'url(' + banksMap[offer.bank].img + ')'
              }"
            >
              <div class="nr">
                <p>{{ i + 1 }}</p>
              </div>
            </div>
            <div class="offer-product">
              <a [href]="offer.bankUrl" target="_blank"
                >{{ offer.bankName }} <mat-icon>open_in_new</mat-icon></a
              >
              <h3 (click)="openOfferDialog(offer)" class="clickable">
                {{ offer.productName }}<mat-icon>help</mat-icon>
              </h3>
            </div>
          </div>
          <div class="the-offer-body">
            <div class="small-header"><p>Rentebesparelse</p></div>
            <div class="split">
              <div class="offer-inner save">
                <h2 *ngIf="offer.totalSavings > 0; else noTotalSavings">
                  {{ offer.totalSavings | abs | number }},-
                </h2>
                <ng-template #noTotalSavings>
                  <h2>0,-</h2>
                </ng-template>
                <p>over lånets løpetid</p>
              </div>
              <div class="offer-inner save">
                <h2 *ngIf="offer.savingsFirstYear > 0; else noTotalSavings">
                  {{ offer.savingsFirstYear | abs | number }},-
                </h2>
                <ng-template #noSavingsFirstYear>
                  <h2>0,-</h2>
                </ng-template>
                <p>første år</p>
              </div>
            </div>
            <div class="split">
              <div class="offer-info">
                <div class="small-header">
                  <p>Effektiv rente</p>
                </div>
                <div class="offer-inner">
                  <h2>{{ offer.effectiveRate | number: "1.2-2" }}%</h2>
                </div>
              </div>
              <div class="offer-info">
                <div class="small-header">
                  <p>Krever tilleggsprodukt</p>
                </div>
                <div class="offer-inner">
                  <h2>
                    {{ offer.requiredProductPackage == null ? "Nei" : "Ja" }}
                  </h2>
                </div>
              </div>
            </div>
          </div>
          <div class="double buttons">
            <div class="full-width">
              <rente-button
                [disabled]="
                  changeBankLoading ||
                  offersInfo.offerSavingsType === offerSavingsType.NO_SAVINGS
                "
                [isLoading]="changeBankLoading"
                color="primary"
                type="raised"
                (click)="openChangeBankDialog(offersInfo.offers[i])"
                >Match tilbud</rente-button
              >
            </div>
            <div class="full-width">
              <rente-button
                [disabled]="true"
                [isLoading]="changeBankLoading"
                color="primary"
                type="raised"
                (click)="openChangeBankDialog(offersInfo.offers[i])"
                >Start bytte</rente-button
              >
              <p class="small">(Kommer snart!)</p>
            </div>
          </div>
        </div>
      </ng-container>
    </div>
  </div>
</div>
<div class="problems">
  <div
    class="title"
    *ngIf="
      offersInfo?.resultType === offersResultType.NO_OFFERS ||
      offersInfo?.resultType === offersResultType.LTV_TOO_HIGH_85
    "
  >
    <h3>
      Størrelsen på lånet ditt er for stor i forhold til boligverdi (>85%).
    </h3>
    <p>
      Kontroller og endre boligverdien din
      <a [routerLink]="['/dashboard/bolig']">her i boligfanen</a>
    </p>
  </div>
  <div
    class="title"
    *ngIf="
      offersInfo?.resultType === offersResultType.LTV_CREDIT_LINE_TOO_HIGH_60
    "
  >
    <h3>
      Rammelån/boligkreditt er kun tilgjengelig for lavere belåningsgrad enn
      60%.
    </h3>
    <p>
      Din belåningsgrad er høyere enn dette, vennligst endre din belåningsgrad
      i<a [routerLink]="['/dashboard/bolig']"> boligfanen</a>
    </p>
  </div>
  <div class="title" *ngIf="!offersInfo && !isLoading && !errorMessage">
    <h3>Ingen bedre tilbud enda...</h3>
  </div>

  <div class="title" *ngIf="errorMessage">
    <h3>{{ errorMessage }}</h3>
  </div>
</div>

<div *ngIf="effRateLoweredDialogVisible">
  <rente-dialog
    [title]="'Du har lavere rente enn forrige gang!'"
    [message]="'Brukte du prutefunksjonen vår for å få bedre rente?'"
    (action)="onDialogAction($event)"
  >
  </rente-dialog>
</div>
<!-- <div
  class="offers"
  [class.blured]="isDialogVisble"
  *ngIf="offersInfo?.resultType === offersResultType.OFFERS_PRESENT"
  [@shakeAnimation]
>
  <div *ngIf="!isSmallScreen; else smallScreenOffers">
    <h3>Din rente:</h3>
    <div class="row">
      <div class="col-12 col-lg-5">
        <rente-rating
          [rating]="
            offersService.getRatingNumberFromLoanState(
              offersInfo.offerSavingsType
            )
          "
        ></rente-rating>
        <div [ngSwitch]="offersInfo.offerSavingsType">
          <h4 class="my-2" *ngSwitchCase="offerSavingsType.NO_SAVINGS">
            Renten din er svært god
          </h4>
          <h4
            class="my-2"
            *ngSwitchCase="
              offerSavingsType.SAVINGS_FIRST_YEAR_BETWEEN_0_AND_2000
            "
          >
            Renten din er god, men ikke best
          </h4>
          <h4
            class="my-2"
            *ngSwitchCase="
              offerSavingsType.SAVINGS_FIRST_YEAR_BETWEEN_2000_AND_6000
            "
          >
            Renten din er OK, med du kan få bedre
          </h4>
          <h4
            class="my-2"
            *ngSwitchCase="
              offerSavingsType.SAVINGS_FIRST_YEAR_BETWEEN_6000_AND_10000
            "
          >
            Renten din er høy og du kan spare en del
          </h4>
          <h4
            class="my-2"
            *ngSwitchCase="offerSavingsType.SAVINGS_FIRST_YEAR_GREATER_10000"
          >
            Renten din er svært høy - du har mye å spare
          </h4>
          <div *ngSwitchDefault>-</div>
        </div>

        <p
          class="text-border"
          *ngIf="
            offersInfo.aggregatedLoanType === aggregatedLoanType.CREDIT_LINE ||
            offersInfo.aggregatedLoanType === aggregatedLoanType.MIX_D_C
          "
        >
          Tips: Boligverdi/belåningsgrad er viktig mtp hva bankene tilbyr. Du
          kan endre i
          <a [routerLink]="['/dashboard/bolig']">
            Bolig fanen
          </a>
          <br />
          Du kan også se
          <a
            [routerLink]="['/dashboard/bolig']"
            [queryParams]="{ statistikk: true }"
            >statistikk (feks. prisutvikling)</a
          >
          om din bolig.
        </p>
        <p class="text-border" *ngIf="!offersInfo.memberships.length">
          Enkelte banker tilbyr bedre betingelser gitt at du har et medlemskap i
          en interesseorganisasjon. Hvis du har mulighet til å bli medlem prøv
          gjerne å endre ditt medlemskap ved å
          <a [routerLink]="'/dashboard/profil'">klikke her</a> for å se om det
          påvirker resultatet av din rentesjekk. (Medlemskap pleier å koste ca
          4000 i året)
        </p>
        <p
          class="text-border"
          *ngIf="
            offersInfo.aggregatedRateType ===
            aggregatedRateType.MIX_FIXED_FLOATING
          "
        >
          Vi ser du har ett eller flere fastrentelån. Renteradar viser
          besparelsespotensialet kun for lånet/lånene med flytende rente. Beste
          rente viser også kun beste rente for lånet/lånene med flytende rente.
        </p>
        <p
          class="text-border"
          *ngIf="
            offersInfo.aggregatedLoanType === aggregatedLoanType.MIX_D_C ||
            offersInfo.aggregatedLoanType === aggregatedLoanType.CREDIT_LINE
          "
        >
          Du har rammelån/boligkreditt. Ønsker du å se tilbud kun for denne
          typen lån kan du endre dette i
          <a [routerLink]="'/dashboard/preferanser'">preferanser</a>
        </p>

        <p class="text-border" *ngIf="hasStatensPensjonskasseMembership">
          Medlemmer i Statens Pensjonskasse kan finansiere opptil 2 millioner
          hos Statens Pensjonskasse. For mer info om tilbudet
          <a
            target="_blank"
            href="https://www.finansportalen.no/bank/boliglan/product/46473/"
            >klikk her</a
          >
        </p>
      </div>
      <div class="col-12 col-lg-7 text-center">
        <div class="row mb-4">
          <div class="col-12 col-sm-7 mb-3 mb-lg-0">
            <div class="bg-wrap h-120">
              <p class="mb-0">Du kan spare:</p>
              <h3 *ngIf="offersInfo.bestOfferTotalSaving > 0; else noBestOffer">
                {{ offersInfo.bestOfferTotalSaving | abs | number }},-
              </h3>
              <ng-template #noBestOffer>
                <h3>0,-</h3>
              </ng-template>
              <p class="mb-0">over lånets løpetid</p>
            </div>
          </div>
          <div class="col-12 col-sm-5">
            <div class="bg-wrap h-120">
              <p class="mb-0">Gjenværende lån:</p>
              <h3>
                {{
                  offersInfo.totalOutstandingDebt / 1000000 | number: "1.1-3"
                }}
                millioner
              </h3>
              <p class="mb-0">
                Belåningsgrad
                {{
                  (offersInfo.totalOutstandingDebt / offersInfo.propertyValue) *
                    100 | number: "1.1-1"
                }}%
              </p>
            </div>
          </div>
        </div>
        <div class="row">
          <div class="col-12 col-sm-7">
            <div class="row">
              <div class="col-12 col-sm-6 mb-3">
                <div class="bg-wrap px-0 h-120">
                  <p>Din eff. rente:</p>
                  <h3>
                    {{ offersInfo.totalEffectiveRate | number: "1.2-2" }}%
                  </h3>
                </div>
              </div>
              <div class="col-12 col-sm-6 mb-3">
                <div class="bg-wrap px-0 h-120">
                  <p>Beste tilbud:</p>
                  <h3>
                    {{ offersInfo.bestOfferEffectiveRate | number: "1.2-2" }}%
                  </h3>
                </div>
              </div>
            </div>
          </div>
          <div class="col-12 col-sm-5">
            <div class="bg-wrap px-0 h-120">
              <p class="mb-0">Boligverdi:</p>
              <h3>
                {{ offersInfo.propertyValue / 1000000 | number: "1.1-3" }}
                millioner
              </h3>
              <p class="mb-0">
                Estimat levert av
                <a href="https://virdi.no/" target="_blank">virdi.no</a>
              </p>
            </div>
          </div>
          <rente-button
            class="mt-2 col-12"
            [disabled]="
              changeBankLoading ||
              offersInfo.offerSavingsType === offerSavingsType.NO_SAVINGS
            "
            [isLoading]="changeBankLoading"
            color="primary"
            type="raised"
            (click)="openChangeBankDialog(offersInfo.offers[0])"
            >Be min bank matche beste tilbud</rente-button
          >
        </div>
      </div>
    </div>
    <rente-offers-statistics [offersInfo]="offersInfo">
    </rente-offers-statistics>
    <h3 class="mb-4">Beste tilbud:</h3>
    <ng-container *ngIf="offersInfo">
      <div
        class="bg-wrap offers-bank mb-5"
        *ngFor="let offer of offersInfo.offers; let i = index"
      >
        <div class="row">
          <div class="col-12 col-sm-6 pt-0 pt-lg-2">
            <div class="row">
              <div class="col-12 col-sm-4 mb-2 mb-lg-0">
                <img
                  class="mw-120"
                  *ngIf="banksMap[offer.bank].img"
                  [src]="banksMap[offer.bank].img"
                  alt=""
                  title="banksMap[offer.bank].label"
                />
              </div>
              <div class="col-12 col-sm-8">
                <div class="mb-2 mb-lg-4">
                  <p class="mb-0 mb-lg-2">{{ offer.bankName }}</p>
                  <h3>{{ offer.productName }}</h3>
                </div>
                <div class="row">
                  <div class="col-12 col-sm-6 mb-2 mb-lg-0">
                    <p class="mb-0 mb-lg-2">
                      Rentebesparelse over lånets løpetid:
                    </p>
                    <h3 *ngIf="offer.totalSavings > 0; else noTotalSavings">
                      {{ offer.totalSavings | abs | number }},-
                    </h3>
                    <ng-template #noTotalSavings>
                      <h3>0,-</h3>
                    </ng-template>
                  </div>
                  <div class="col-12 col-sm-6 mb-2 mb-lg-0">
                    <p class="mb-0 mb-lg-2">Rentebesparelse første år:</p>
                    <h3 *ngIf="offer.savingsFirstYear > 0; else noTotalSavings">
                      {{ offer.savingsFirstYear | abs | number }},-
                    </h3>
                    <ng-template #noSavingsFirstYear>
                      <h3>0,-</h3>
                    </ng-template>
                  </div>
                </div>
              </div>
            </div>
          </div>
          <div class="col-12 col-sm-6 pt-0 pt-lg-2">
            <div class="row">
              <div class="col-12 col-sm-7 ">
                <div class="row">
                  <div class="col-12 col-sm-12 mb-2 mb-lg-4">
                    <p class="mb-0 mb-lg-2">Effektiv rente:</p>
                    <h3>{{ offer.effectiveRate | number: "1.2-2" }}%</h3>
                  </div>
                  <div class="col-12 col-sm-12 mb-4 mb-lg-0">
                    <p class="mb-0 mb-lg-2">
                      Krever annet produkt (e.g. lønnskonto):
                    </p>
                    <h3>
                      {{ offer.requiredProductPackage == null ? "Nei" : "Ja" }}
                    </h3>
                  </div>
                </div>
              </div>
              <div class="col-12 col-sm-5">
                <rente-button
                  class="mb-2"
                  color="primary"
                  type="stroked"
                  (click)="openOfferDialog(offer)"
                  >Mer info
                </rente-button>
                <rente-button
                  class="mt-2"
                  color="primary"
                  type="stroked"
                  [href]="offer.bankUrl"
                  >Bankens hjemmeside</rente-button
                >
                <rente-button
                  class="mt-2"
                  [disabled]="
                    changeBankLoading ||
                    offersInfo.offerSavingsType === offerSavingsType.NO_SAVINGS
                  "
                  [isLoading]="changeBankLoading"
                  color="primary"
                  type="raised"
                  (click)="openChangeBankDialog(offer)"
                  >Be min bank matche dette tilbudet</rente-button
                >
                <rente-button
                  class="mt-2"
                  [disabled]="true"
                  color="primary"
                  type="raised"
                  >Start bytte*
                </rente-button>
                <p class="text-right coming-soon-text">
                  *Kommer snart
                </p>
              </div>
            </div>
          </div>
        </div>
      </div>
    </ng-container>
  </div>

  <ng-template #smallScreenOffers>
    <h3>Rentebarometer</h3>
    <div class="row">
      <div class="col-12 col-lg-5">
        <rente-rating
          [rating]="
            offersService.getRatingNumberFromLoanState(
              offersInfo.offerSavingsType
            )
          "
        ></rente-rating>
        <div [ngSwitch]="offersInfo.offerSavingsType">
          <h4 class="my-2" *ngSwitchCase="offerSavingsType.NO_SAVINGS">
            Renten din er svært god
          </h4>
          <h4
            class="my-2"
            *ngSwitchCase="
              offerSavingsType.SAVINGS_FIRST_YEAR_BETWEEN_0_AND_2000
            "
          >
            Renten din er god, men ikke best
          </h4>
          <h4
            class="my-2"
            *ngSwitchCase="
              offerSavingsType.SAVINGS_FIRST_YEAR_BETWEEN_2000_AND_6000
            "
          >
            Renten din er OK, med du kan få bedre
          </h4>
          <h4
            class="my-2"
            *ngSwitchCase="
              offerSavingsType.SAVINGS_FIRST_YEAR_BETWEEN_6000_AND_10000
            "
          >
            Renten din er høy og du kan spare en del
          </h4>
          <h4
            class="my-2"
            *ngSwitchCase="offerSavingsType.SAVINGS_FIRST_YEAR_GREATER_10000"
          >
            Renten din er svært høy - du har mye å spare
          </h4>
          <div *ngSwitchDefault>-</div>
        </div>

      </div>
      <div class="col-12 text-center">
        <div class="row mb-2">
          <div class="col-12 mb-lg-0">
            <div class="bg-wrap">
              <p class="mb-0">Du kan spare:</p>
              <h3 *ngIf="offersInfo.bestOfferTotalSaving > 0; else noBestOffer">
                {{ offersInfo.bestOfferTotalSaving | abs | number }},-
              </h3>
              <ng-template #noBestOffer>
                <h3>0,-</h3>
              </ng-template>
              <p class="mb-0">over lånets løpetid</p>
            </div>
          </div>
        </div>
        <div class="row mb-2">
          <div class="col-6">
            <div class="bg-wrap px-0">
              <p class="paragraph-mobile">Din eff. rente:</p>
              <h4 class="m-0 font-weight-bold">
                {{ offersInfo.totalEffectiveRate | number: "1.2-2" }}%
              </h4>
            </div>
          </div>
          <div class="col-6">
            <div class="bg-wrap px-0">
              <p class="paragraph-mobile">Beste tilbud:</p>
              <h4 class="m-0 font-weight-bold">
                {{ offersInfo.bestOfferEffectiveRate | number: "1.2-2" }}%
              </h4>
            </div>
          </div>
        </div>

        <div class="row">
          <div class="col-6">
            <div class="bg-wrap px-0 h-100">
              <p class="paragraph-mobile">Boligverdi:</p>
              <h4 class="m-0 font-weight-bold">
                {{ offersInfo.propertyValue / 1000000 | number: "1.1-3" }} mill.
              </h4>
              <p class="mb-0 paragraph-mobile-estimate">
                Estimat levert av
                <a href="https://virdi.no/" target="_blank">virdi.no</a>
              </p>
            </div>
          </div>
          <div class="col-6">
            <div class="bg-wrap px-0 h-100">
              <p class="paragraph-mobile mb-0">Gjenværende lån:</p>
              <h4 class="m-0 font-weight-bold">
                {{
                  offersInfo.totalOutstandingDebt / 1000000 | number: "1.1-3"
                }}
                mill.
              </h4>
              <p class="mb-0 paragraph-mobile-estimate">
                Belåningsgrad
                {{
                  (offersInfo.totalOutstandingDebt / offersInfo.propertyValue) *
                    100 | number: "1.1-1"
                }}%
              </p>
            </div>
          </div>
        </div>
      </div>
      <rente-button
        class="mt-4 mb-2 col-12 change-bank-button-mobile"
        color="primary"
        type="raised"
        [disabled]="
          changeBankLoading ||
          offersInfo.offerSavingsType === offerSavingsType.NO_SAVINGS
        "
        [isLoading]="changeBankLoading"
        (click)="openChangeBankDialog(offersInfo.offers[0])"
        >Be min bank matche beste tilbud</rente-button
      >
      <div class="col-12" [@inOutAnimation] *ngIf="isShowTips">
        <div class="row justify-content-start mt-2">
          <div class="col-12 pl-2" (click)="isShowTips = !isShowTips">
            <mat-icon>close</mat-icon>
          </div>
        </div>
        <p class="text-border mt-0">
          Tips: Boligverdi/belåningsgrad er viktig mtp hva bankene tilbyr. Du
          kan endre i
          <a [routerLink]="['/dashboard/bolig']">
            Bolig fanen
          </a>
        </p>
        <p class="text-border" *ngIf="!offersInfo.memberships.length">
          Enkelte banker tilbyr bedre betingelser gitt at du har et medlemskap i
          en interesseorganisasjon. Hvis du har mulighet til å bli medlem prøv
          gjerne å endre ditt medlemskap ved å
          <a [routerLink]="'/dashboard/profil'">klikke her</a> for å se om det
          påvirker resultatet av din rentesjekk. (Medlemskap pleier å koste ca
          4000 i året)
        </p>
        <p
          class="text-border"
          *ngIf="
            offersInfo.aggregatedRateType ===
            aggregatedRateType.MIX_FIXED_FLOATING
          "
        >
          Vi ser du har ett eller flere fastrentelån. Renteradar viser
          besparelsespotensialet kun for lånet/lånene med flytende rente. Beste
          rente viser også kun beste rente for lånet/lånene med flytende rente.
        </p>
        <p
          class="text-border"
          *ngIf="
            offersInfo.aggregatedLoanType === aggregatedLoanType.CREDIT_LINE ||
            offersInfo.aggregatedLoanType === aggregatedLoanType.MIX_D_C
          "
        >
          Du har rammelån/boligkreditt. Ønsker du å se tilbud kun for denne
          typen lån kan du endre dette i
          <a [routerLink]="'/dashboard/preferanser'">preferanser</a>
        </p>
      </div>
    </div>
    <div class="row justify-content-center">
      <div id="bankChart" class="col-12"></div>
      <div id="groupChart" class="col-12"></div>
      <div class="col-12"></div>
    </div>
    <rente-offers-statistics [offersInfo]="offersInfo">
    </rente-offers-statistics>
    <h3 class="mb-4">Beste tilbud:</h3>
    <ng-container *ngIf="offersInfo">
      <div
        class="bg-wrap offers-bank mb-5"
        *ngFor="let offer of offersInfo.offers; let i = index"
      >
        <div class="row">
          <div class="col-12">
            <div class="row">
              <div class="col-5 col-lg-3 col-lg-2 mb-2">
                <img
                  class="mw-100"
                  *ngIf="banksMap[offer.bank].img"
                  [src]="banksMap[offer.bank].img"
                  alt=""
                  title="banksMap[offer.bank].label"
                />
              </div>
              <div class="col-7 col-lg-9 col-lg-10 px-0">
                <div>
                  <p class="mb-0">{{ offer.bankName }}</p>
                  <h4 class="font-weight-bold my-0">{{ offer.productName }}</h4>
                </div>
              </div>
              <div class="col-12 mt-2">
                <div class="row mb-4">
                  <div class="col-6 pr-0">
                    <p class="paragraph-mobile">
                      Rentebesparelse over lånets løpetid:
                    </p>
                    <h3 *ngIf="offer.totalSavings > 0; else noTotalSavings">
                      {{ offer.totalSavings | abs | number }},-
                    </h3>
                    <ng-template #noTotalSavings>
                      <h3>0,-</h3>
                    </ng-template>
                  </div>
                  <div class="col-6">
                    <p class="paragraph-mobile">Rentebesparelse første år:</p>
                    <h3 *ngIf="offer.savingsFirstYear > 0; else noTotalSavings">
                      {{ offer.savingsFirstYear | abs | number }},-
                    </h3>
                    <ng-template #noSavingsFirstYear>
                      <h3>0,-</h3>
                    </ng-template>
                  </div>
                </div>
              </div>
              <div class="col-12">
                <div class="row mb-4">
                  <div class="col-6">
                    <p class="paragraph-mobile">Effektiv rente:</p>
                    <h3>{{ offer.effectiveRate | number: "1.2-2" }}%</h3>
                  </div>
                  <div class="col-6 px-0 px-lg-3">
                    <p class="paragraph-mobile">
                      Krever annet produkt (e.g. lønnskonto):
                    </p>
                    <h3>
                      {{ offer.requiredProductPackage == null ? "Nei" : "Ja" }}
                    </h3>
                  </div>
                </div>
              </div>
            </div>
          </div>
          <div class="col-12">
            <div class="row">
              <div class="col-12">
                <rente-button
                  class="mb-2"
                  color="primary"
                  type="stroked"
                  (click)="openOfferDialog(offer)"
                  >Mer info
                </rente-button>
                <rente-button
                  class="mt-2"
                  color="primary"
                  type="stroked"
                  [href]="offer.bankUrl"
                  >Bankens hjemmeside</rente-button
                >
                <rente-button
                  class="mt-2"
                  color="primary"
                  [disabled]="
                    changeBankLoading ||
                    offersInfo.offerSavingsType === offerSavingsType.NO_SAVINGS
                  "
                  [isLoading]="changeBankLoading"
                  type="raised"
                  (click)="openChangeBankDialog(offer)"
                  >Be min bank matche dette tilbudet</rente-button
                >
                <rente-button
                  class="mt-2"
                  [disabled]="true"
                  color="primary"
                  type="raised"
                  >Start bytte*
                </rente-button>
                <p class="text-right coming-soon-text">
                  *Kommer snart
                </p>
              </div>
            </div>
          </div>
        </div>
      </div>
    </ng-container>
  </ng-template>
</div>

<div
  class="my-5 row justify-content-center"
  *ngIf="
    offersInfo?.resultType === offersResultType.NO_OFFERS ||
    offersInfo?.resultType === offersResultType.LTV_TOO_HIGH_85
  "
>
  <div class="my-5 row justify-content-center">
    <div class="col-lg-6 col-lg-8 col-12">
      <div class="bg-wrap">
        <h3>
          Størrelsen på lånet ditt er for stor i forhold til boligverdi (>85%).
          Kontroller og endre boligverdien din
          <a [routerLink]="['/dashboard/bolig']">her i boligfanen</a>
        </h3>
      </div>
    </div>
  </div>
</div>

<div
  class="my-5 row justify-content-center"
  *ngIf="
    offersInfo?.resultType === offersResultType.LTV_CREDIT_LINE_TOO_HIGH_60
  "
>
  <div class="my-5 row justify-content-center">
    <div class="col-lg-6 col-lg-8 col-12">
      <div class="bg-wrap">
        <h3>
          Rammelån/boligkreditt er kun tilgjengelig for lavere belåningsgrad enn
          60%. Din belåningsgrad er høyere enn dette, vennligst endre din
          belåningsgrad i<a [routerLink]="['/dashboard/bolig']"> boligfanen</a>
        </h3>
      </div>
    </div>
  </div>
</div>

<div
  class="loading"
  *ngIf="isLoading && !errorMessage"
>
  <mat-spinner [diameter]="48" [strokeWidth]="4"></mat-spinner>
</div>

<div *ngIf="!offersInfo && !isLoading && !errorMessage">
  <h1 class="text-center mt-4">No offers yet...</h1>
</div>

<div *ngIf="errorMessage">
  <h1 class="text-center mt-4">{{ errorMessage }}</h1>
</div>

<div
  *ngIf="effRateLoweredDialogVisible"
  class="d-flex justify-content-center centered-popup"
>
  <rente-dialog
    [title]="'Hei! Du har lavere rente enn forrige gang'"
    [message]="
      'Vi ser du har fått lavere rente siden forrige gang du brukte Renteradar.no. Brukte du prutefunksjonen i Renteradar.no til å få bedre rente?'
    "
    (action)="onDialogAction($event)"
  >
  </rente-dialog>
</div>
 -->
