


<div class="dashboard-wrapper">

<div class="loading" *ngIf="isLoading && !errorMessage">
  <mat-spinner [diameter]="48" [strokeWidth]="4"></mat-spinner>
</div>

<div
  class="offers"
  *ngIf="
    offersInfo?.ltvType === offersLtvType.LTV_OK ||
    offersInfo?.ltvType === offersLtvType.LTV_TOO_HIGH_85"
>

<div class ="desktop">
  <a
      *ngIf="offersInfo?.ltvType === offersLtvType.LTV_TOO_HIGH_85"
      class="obs clickable"  
      (click)="openLtvTooHightDialog()"
    >
    
      <p>
        <b>OBS:</b> Vi har beregnet belåningsgraden din til over 85%. 
        Vennligst kontroller boligverdien i boligfanen. Du kan også lese 
        mer om dette ved å  <a >klikke her</a>.
        ng
      </p>
  </a>

  <div
      *ngIf="
        offersInfo?.incompleteInfoLoanPresent === true
      "
      class="obs"
    >
      <p>
        <b>OBS:</b> Vi får kun hentet din nominelle rente og lånebeløp. For
        utregninger har vi tatt utgangspunkt i en gjenværende løpetid på 20 år,
        månedlige betalinger og 50,- i termingebyr. Faktisk løpetid og
        termingebyrer vil endre forventede besparelser.
      </p>
    </div>
</div>

  <div class="dashboard-inner-wrapper">
    <div class="rente-boxes desktop-main-box-grid desktop">

      <!-- barometer -->
      <div class="barometer round-box">
        <div class="rente-status" [ngSwitch]="offersInfo.offerSavingsType">
          <p *ngSwitchCase="offerSavingsType.NO_SAVINGS">
            Renten din er <b>svært god</b>
          </p>
          <p
            *ngSwitchCase="
              offerSavingsType.SAVINGS_FIRST_YEAR_BETWEEN_0_AND_2000
            "
          >
            Renten din er <b>god</b>, men ikke best
          </p>
          <p
            *ngSwitchCase="
              offerSavingsType.SAVINGS_FIRST_YEAR_BETWEEN_2000_AND_6000
            "
          > 
            Renten din er <b>OK</b>, men du kan få bedre
          </p>
          <p
            *ngSwitchCase="
              offerSavingsType.SAVINGS_FIRST_YEAR_BETWEEN_6000_AND_10000
            "
          >
            Renten din er <b>dårlig</b> og du kan spare en del
          </p>
          <p *ngSwitchCase="offerSavingsType.SAVINGS_FIRST_YEAR_GREATER_10000">
            Renten din er <b>svært  dårlig</b> 
          </p>
          <div *ngSwitchDefault>-</div>
        </div>
    
        <div class="rente-bar-container center-horizontal">
          <div class="bar-ticks">
            <p>Dårlig rente</p>
            <p>Bra rente</p>
          </div>
          <div class="bar-wrap" > 
            <span class="bar-fill-left" [ngClass]="[rateBarPercentage.class]" [ngStyle]="{'width': rateBarPercentage.percentage + '%'}"></span>
            <span class="bar-fill-right" [ngStyle]="{'width': rateBarPercentageInverted + '%'}"></span> 
          </div>
    
          <!--
          <div class="arrow-box center-align" [ngStyle]="{'left': barBoxPosition}">
            <p>Din rente</p>
          </div>
          --> 
        </div>
    
        <div class="save-info">
          <p>Du kan spare</p>
            <h2 *ngIf="offersInfo.bestOfferTotalSaving > 0; else noBestOffer">
              {{ offersInfo.bestOfferTotalSaving | abs | number }},-
            </h2>
            <ng-template #noBestOffer>
              <h2> 0,- </h2>
            </ng-template>
          <p>over lånets løpetid</p>
        </div>
      </div>
      <!-- End barometer -->

      <div class="info-box-grid">
          
        <div class="box round-box blue-bg">
          <img src="../../../../assets/icons/rate.svg"/>
          <p>Din effektive rente</p>
          <h2>{{ offersInfo.totalEffectiveRate | number: "1.2-2" }}%</h2>
        </div>
        <a class="box round-box primary-bg positive clickable" (click)="goToBestOffer()">
          <img src="../../../../assets/icons/rente-icon-white.svg"/>
          <p>
            Beste tilbud 
          </p>
          <h2>
            {{ offersInfo.bestOfferEffectiveRate | number: "1.2-2" }}%
          </h2>
          <img class="arrow-big" src="../../../../assets/icons/arrow-big.svg"/>
        
        </a>
    
        <a class="box round-box blue-bg clickable" (click)="goToProperty()">
          <img src="../../../../assets/icons/house.svg"/>
          <p>
            Boligverdi 
          </p>
          <h2>
            {{ offersInfo.propertyValue / 1000000 | number: "1.1-3" }}
            mill.
          </h2>
          <p class="small">
              Fellesgjeld
            {{
              (offersInfo.commonDebt / 1000000 | number: "1.1-2")
            }}
            mill.
          </p>
        
          <p class="extra-small-virdi">
            Estimat levert av
            <a href="https://virdi.no/" target="_blank">virdi.no</a>
          </p>
          <img class="arrow-big" src="../../../../assets/icons/arrow-big.svg"/>
        </a>
        <a class="box round-box blue-bg clickable" (click)="goToLoans()">
          <img src="../../../../assets/icons/rate.svg"/>
          <p>
            Gjenværende lån <img src="../../../../assets/icons/go_to.svg" />
          </p>
          <h2>
            {{
              offersInfo.totalOutstandingDebt / 1000000 | number: "1.1-3"
            }}
            mill.
          </h2>
          <p class="small">
            Belåningsgrad
            {{
              (offersInfo.ltv) *
                100 | number: "1.1-1"
            }}%
          </p>
          <img class="arrow-big margin-top-extra" src="../../../../assets/icons/arrow-big.svg"/>
        </a>

        
      </div>
      <!-- end desktop rente-info-grid-->


      <div *ngIf="!isMobile" class="compared">
        <rente-offers-statistics [offersInfo]="offersInfo">
        </rente-offers-statistics>
      </div>


      <div
          class="tipsAccordion round-box clickable"
          (click)="isShowTips = !isShowTips"
          *ngIf="tips.length > 0"
        >
        <p>
          <mat-icon *ngIf="!isShowTips">expand_more</mat-icon>
          <mat-icon *ngIf="isShowTips">expand_less</mat-icon>
          <span class="nr">{{ tips.length }}</span> tips
        </p>
      </div>
        
        <div class="tips round-box" *ngIf="isShowTips && tips.length > 0">
          <div
            *ngFor="let tip of tips; let i = index"
            [ngClass]="tip.buttonLink === './' ? 'tip-wrapper' : 'clickable tip-wrapper'"
          >
            <div
              *ngIf="!tip.external"
              routerLink="{{ tip.buttonLink }}"
              class="tip"
            >
              
              <div class= "tipTop">
              <img src="../../../../assets/icons/{{tip.icon}}.svg"/>
              <h4>Låneinfo</h4>
              </div>
              <p>
                {{ tip.text }}
              </p>

              <mat-icon *ngIf="tip.buttonLink !== './'">chevron_right</mat-icon>
            </div>

            <a
              *ngIf="tip.external"
              href="{{ tip.buttonLink }}"
              target="_blank"
              class="tip"
            >
              <img src="../../../../assets/icons/{{tip.icon}}.svg"/>
              <p>
                {{ tip.text }}
              </p>

              <mat-icon>chevron_right</mat-icon>
            </a>
          </div>
        </div>
        <!-- end tips -->

      <div class= "cta-boxes-desktop">
        <div class="big-box round-box">
          <div class="top">
            <div class="circleIconWrapper"><img class="" src="../../../../assets/icons/rente-green-big.svg"/></div>
            <p>
                Vi har funnet de beste tilbudene for deg
            </p>
          </div>
          <div class="bottom">
            <rente-button color="primary-wide">
              Se beste tilbud
            </rente-button>
          </div>
        </div>
      
        <div class="big-box round-box">
          <div class="top">
            <div class="circleIconWrapper"><img class="" src="../../../../assets/icons/mail-green.svg"/></div>
            <p>Vi hjelper deg å be banken din om lavere rente</p>
          </div>
          <div class="bottom">
            <rente-button color="primary-wide-hollow">
              Be banken matche tilbud
            </rente-button>
          </div>
        </div>
      </div>
    </div>


    <!-- Mobile boxes -->
    <div class="rente-boxes mobile">
      <div class="info-box-grid">

        <!-- barometer -->
        <div class="barometer round-box">
          <div class="rente-status" [ngSwitch]="offersInfo.offerSavingsType">
            <p *ngSwitchCase="offerSavingsType.NO_SAVINGS">
              Renten din er <b>svært god</b>
            </p>
            <p
              *ngSwitchCase="
                offerSavingsType.SAVINGS_FIRST_YEAR_BETWEEN_0_AND_2000
              "
            >
              Renten din er <b>god</b>, men ikke best
            </p>
            <p
              *ngSwitchCase="
                offerSavingsType.SAVINGS_FIRST_YEAR_BETWEEN_2000_AND_6000
              "
            > 
              Renten din er <b>OK</b>, men du kan få bedre
            </p>
            <p
              *ngSwitchCase="
                offerSavingsType.SAVINGS_FIRST_YEAR_BETWEEN_6000_AND_10000
              "
            >
              Renten din er <b>dårlig</b> og du kan spare en del
            </p>
            <p *ngSwitchCase="offerSavingsType.SAVINGS_FIRST_YEAR_GREATER_10000">
              Renten din er <b>svært  dårlig</b> 
            </p>
            <div *ngSwitchDefault>-</div>
          </div>
      
          <div class="rente-bar-container center-horizontal">
            <div class="bar-ticks">
              <p>Dårlig rente</p>
              <p>Bra rente</p>
            </div>
  
            <div class="bar-wrap" > 
              <span class="bar-fill-left" [ngClass]="[rateBarPercentage.class]" [ngStyle]="{'width': rateBarPercentage.percentage + '%'}"></span>
              <span class="bar-fill-right" [ngStyle]="{'width': rateBarPercentageInverted + '%'}"></span> 
            </div>
      
            <!--
            <div class="arrow-box center-align" [ngStyle]="{'left': barBoxPosition}">
              <p>Din rente</p>
            </div>
            --> 
          </div>
      
          <div class="save-info">
            <p>Du kan spare</p>
              <h2 *ngIf="offersInfo.bestOfferTotalSaving > 0; else noBestOffer">
                {{ offersInfo.bestOfferTotalSaving | abs | number }},-
              </h2>
              <ng-template #noBestOffer>
                <h2> 0,- </h2>
              </ng-template>
            <p>over lånets løpetid</p>
          </div>
        </div>
        <!-- End barometer -->



        <div class="box round-box blue-bg">
          <img src="../../../../assets/icons/rate.svg"/>
          <p>Din effektive rente</p>
          <h2>{{ offersInfo.totalEffectiveRate | number: "1.2-2" }}%</h2>
        </div>
        <a class="box round-box primary-bg positive clickable" (click)="goToBestOffer()">
          <img src="../../../../assets/icons/rente-icon-white.svg"/>
          <p>
            Beste tilbud 
          </p>
          <h2>
            {{ offersInfo.bestOfferEffectiveRate | number: "1.2-2" }}%
          </h2>
          <img class="arrow-big" src="../../../../assets/icons/arrow-big.svg"/>
        
        </a>
    
        <a class="box round-box blue-bg clickable" (click)="goToProperty()">
          <img src="../../../../assets/icons/house.svg"/>
          <p>
            Boligverdi 
          </p>
          <h2>
            {{ offersInfo.propertyValue / 1000000 | number: "1.1-3" }}
            mill.
          </h2>
          <p class="small">
              Fellesgjeld
            {{
              (offersInfo.commonDebt / 1000000 | number: "1.1-2")
            }}
            mill.
          </p>
        
          <p class="extra-small-virdi">
            Estimat levert av
            <a href="https://virdi.no/" target="_blank">virdi.no</a>
          </p>
          <img class="arrow-big" src="../../../../assets/icons/arrow-big.svg"/>
        </a>
        <a class="box round-box blue-bg clickable" (click)="goToLoans()">
          <img src="../../../../assets/icons/rate.svg"/>
          <p>
            Gjenværende lån <img src="../../../../assets/icons/go_to.svg" />
          </p>
          <h2>
            {{
              offersInfo.totalOutstandingDebt / 1000000 | number: "1.1-3"
            }}
            mill.
          </h2>
          <p class="small">
            Belåningsgrad
            {{
              (offersInfo.ltv) *
                100 | number: "1.1-1"
            }}%
          </p>
          <img class="arrow-big margin-top-extra" src="../../../../assets/icons/arrow-big.svg"/>
        </a>

  <!-- Mobile Tips -->
    <div class="tipsWrapper round-box">
    <div
      class="tipsAccordion mobile round-box"
      (click)="isShowTips = !isShowTips"
      *ngIf="tips.length > 0"
    >
      <p>
        <mat-icon *ngIf="!isShowTips">expand_more</mat-icon>
        <mat-icon *ngIf="isShowTips">expand_less</mat-icon>
        <span class="nr">{{ tips.length }}</span> tips
      </p>

      
    </div>
    <div
      class="tips"
      style="border-bottom: none;"
      *ngIf="tips.length > 0 && !isShowTips"
    ></div>
    <div class="tips" *ngIf="isShowTips && tips.length > 0">
      <div *ngFor="let tip of tips; let i = index">
        <div
          *ngIf="!tip.external"
          routerLink="{{ tip.buttonLink }}"
          class="tip"
        > 
          <img class="tipIcon" src="../../../../assets/icons/{{tip.icon}}.svg"/>
          <p>
            {{ tip.text }}
          </p>

          <mat-icon *ngIf="tip.buttonLink !== './'">chevron_right</mat-icon>
        </div>

        <a
          *ngIf="tip.external"
          href="{{ tip.buttonLink }}"
          target="_blank"
          class="tip"
        >
          <p>
            {{ tip.text }}
          </p>

          <mat-icon>chevron_right</mat-icon>
        </a>
      </div>

      <div *ngFor="let tip of tips; let i = index">
        <div
          *ngIf="!tip.external"
          routerLink="{{ tip.buttonLink }}"
          class="tip"
        > 
          <img class="tipIcon" src="../../../../assets/icons/{{tip.icon}}.svg"/>
          <p>
            {{ tip.text }}
          </p>

          <mat-icon *ngIf="tip.buttonLink !== './'">chevron_right</mat-icon>
        </div>

        <a
          *ngIf="tip.external"
          href="{{ tip.buttonLink }}"
          target="_blank"
          class="tip"
        >
          <p>
            {{ tip.text }}
          </p>

          <mat-icon>chevron_right</mat-icon>
        </a>
      </div>
    </div>
    <a
      *ngIf="offersInfo?.ltvType === offersLtvType.LTV_TOO_HIGH_85"
      class="obs clickable"  
      (click)="openLtvTooHightDialog()"
    >
    
      <p>
        <b>OBS:</b> Vi har beregnet belåningsgraden din til over 85%. 
        Vennligst kontroller boligverdien i boligfanen. Du kan også lese 
        mer om dette ved å  <a (click)="openLtvTooHightDialog()">klikke her</a>.
        
      </p>
    </a>
    <div
      *ngIf="
        offersInfo?.incompleteInfoLoanPresent === true
      "
      class="obs"
    >
      <p>
        <b>OBS:</b> Vi får kun hentet din nominelle rente og lånebeløp. For
        utregninger har vi tatt utgangspunkt i en gjenværende løpetid på 20 år,
        månedlige betalinger og 50,- i termingebyr. Faktisk løpetid og
        termingebyrer vil endre forventede besparelser.
      </p>
    </div>
    </div>
    <!-- Mobile Tips -->
  </div>

  <div class="split-sections mobile">
    <div class="split-section">
        <div class="mobile">
          <div class="big-box round-box">
            <div class="top">
              <div class="circleIconWrapper"><img class="" src="../../../../assets/icons/rente-green-big.svg"/></div>
              <p>
                  Vi har funnet de beste tilbudene for deg
              </p>
            </div>
            <div class="bottom">
              <rente-button color="primary-wide">
                Se beste tilbud
              </rente-button>
            </div>
          </div>
        
          <div class="big-box round-box">
            <div class="top">
              <div class="circleIconWrapper"><img class="" src="../../../../assets/icons/mail-green.svg"/></div>
              <p>Vi hjelper deg å be banken din om lavere rente</p>
            </div>
            <div class="bottom">
              <rente-button color="primary-wide-hollow">
                Be banken matche tilbud
              </rente-button>
            </div>
          </div>
        </div>
    </div>
  </div>


  <div *ngIf="isMobile" class="compared">
    <rente-offers-statistics [offersInfo]="offersInfo">
    </rente-offers-statistics>
  </div>


  <div class="the-offers">
    <h3 style="margin-bottom: 20px;">
      Beste tilbud:
    </h3>
    <div *ngIf="isMobile" class="sticky-table-header">
      <p>BANK</p>
      <p>Din effektive rente: <span>{{ offersInfo.totalEffectiveRate | number: "1.2-2" }}%</span></p>
    </div>

    <div class="offers-grid">    
      <ng-container *ngIf="offersInfo">
        <div
          *ngFor="let offer of offersInfo.offers.top5; let i = index"
          class="the-offer"
        >

        <ng-container *ngIf="isMobile; else desktop">
          <rente-offer-card [offer]="offer" [offersInfo]="offersInfo" [index]=offer.offerPosition></rente-offer-card>
        </ng-container>
    
        <ng-template #desktop>
          <rente-offer-card-big [offer]="offer" [offersInfo]="offersInfo" [index]=offer.offerPosition></rente-offer-card-big>
        </ng-template>

        </div> 
      </ng-container>
    </div>  
    
    <div class="offers-grid">    
      
      <ng-container *ngIf="offersInfo">
        <div
          *ngFor="let offer of offersInfo.offers.additionalPartnersOffers; let i = index"
          class="the-offer"
        >

        <ng-container *ngIf="isMobile; else desktop">
          <rente-offer-card [offer]="offer" [offersInfo]="offersInfo" [index]=offer.offerPosition></rente-offer-card>
        </ng-container>
    
        <ng-template #desktop>
          <rente-offer-card-big [offer]="offer" [offersInfo]="offersInfo" [index]=offer.offerPosition></rente-offer-card-big>
        </ng-template>
        </div>
      </ng-container>
    </div>
  </div>
  
  
   
</div>
    <!-- Mobile boxes -->






    
  </div>
  
    
  <div class="mobile">  
    <div class="split-sections">
      <div class="split-section">
        
          <div class="mobile">
            <div class="top-buttons full-width">
              <div class="item">
              
              
                <p>Vi har funnet de beste tilbudene for deg</p>
                <rente-button class="min-width vertical-20"
                  [disabled]="changeBankLoading ||
                  offersInfo.offerSavingsType === offerSavingsType.NO_SAVING"
                  [isLoading]="changeBankLoading"
                  color="primary"
                  type="raised"
                  (click)="goToBestOffer()"
                  >Se beste tilbud</rente-button
                >
              </div> 
              
              <div class="item">
          
                <p>Vi hjelper deg å be banken din om lavere rente</p>
                <div class="max-width vertical-20">
                  <rente-button
                    class="min-width"
                    [disabled]="
                    changeBankLoading ||
                    offersInfo.offerSavingsType === offerSavingsType.NO_SAVINGS"
                    [isLoading]="changeBankLoading"
                    color="primary"
                    type="raised"
                    (click)="openChangeBankDialog(offersInfo.offers.top5[0])"
                    >Be banken matche tilbud</rente-button
                  > 
                </div> 
              </div> 
            </div>
          </div>

        <div class="desktop">
        
      </div>
    </div>
  </div> <!-- end mobile-->

</div>

  <div class="desktop">
  
  </div>

  <div class="the-offers">
    <h3 style="margin-bottom: 20px;">
      Beste tilbud:
    </h3>
    <div *ngIf="isMobile" class="sticky-table-header">
      <p>BANK</p>
      <p>Din effektive rente: <span>{{ offersInfo.totalEffectiveRate | number: "1.2-2" }}%</span></p>
    </div>

    <div class="offers-grid">    
      <ng-container *ngIf="offersInfo">
        <div
          *ngFor="let offer of offersInfo.offers.top5; let i = index"
          class="the-offer"
        >

        <ng-container *ngIf="isMobile; else desktop">
          <rente-offer-card [offer]="offer" [offersInfo]="offersInfo" [index]=offer.offerPosition></rente-offer-card>
        </ng-container>
    
        <ng-template #desktop>
          <rente-offer-card-big [offer]="offer" [offersInfo]="offersInfo" [index]=offer.offerPosition></rente-offer-card-big>
        </ng-template>

        </div> 
      </ng-container>
    </div>  
    
    <div class="offers-grid">    
      
      <ng-container *ngIf="offersInfo">
        <div
          *ngFor="let offer of offersInfo.offers.additionalPartnersOffers; let i = index"
          class="the-offer"
        >

        <ng-container *ngIf="isMobile; else desktop">
          <rente-offer-card [offer]="offer" [offersInfo]="offersInfo" [index]=offer.offerPosition></rente-offer-card>
        </ng-container>
    
        <ng-template #desktop>
          <rente-offer-card-big [offer]="offer" [offersInfo]="offersInfo" [index]=offer.offerPosition></rente-offer-card-big>
        </ng-template>
        </div>
      </ng-container>
    </div>
  </div>

</div>
<div class="problems" style="max-width: 780px;">
  
  <div
    class="title"
    *ngIf="
      offersInfo?.ltvType === offersLtvType.LTV_CREDIT_LINE_TOO_HIGH_60
    "
  >
    <h3>
      Rammelån/boligkreditt er kun tilgjengelig for lavere belåningsgrad enn
      60%.
    </h3>
    <p>
      Din belåningsgrad er høyere enn dette, vennligst endre din belåningsgrad
      i<a [routerLink]="['/dashboard/bolig']"> boligfanen</a>
    </p>
  </div>
  <div class="title" *ngIf="!offersInfo && !isLoading && !errorMessage">
    <h3>Ingen bedre tilbud enda...</h3>
  </div>

  <div class="title" *ngIf="errorMessage">
    <h3>{{ errorMessage }}</h3>
  </div>
</div>

<div *ngIf="effRateLoweredDialogVisible">
  <rente-dialog
    [title]="'Du har lavere rente enn forrige gang!'"
    [message]="'Brukte du prutefunksjonen vår for å få bedre rente?'"
    (action)="onDialogAction($event)"
  >
  </rente-dialog>
</div>
</div>
